<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poly Track - InfinitePixels</title>
    <link rel="icon" href="../images/infinitepixlesfav.png" type="image/x-icon">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>

    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <div class="logo-icon">
                    <img src="../images/infinitepixleslogo.webp" alt="InfinitePixels Logo" width="85px" height="85px">
                </div>
                <h2>InfinitePixels</h2>
            </div>
        </div>

        <ul class="nav-links">
            <li>
                <a href="../index.html">
                    <i class="icon">
                        <img src="../images/home.png" alt="Homepage" width="20" height="20">
                    </i>
                    <span>Homepage</span>
                </a>
            </li>
            <li>
                <a href="../games.html">
                    <i class="icon">
                        <img src="../images/games.png" alt="Games" width="20" height="20">
                    </i>
                    <span>Games</span>
                </a>
            </li>
            <li>
                <a href="../random.html">
                    <i class="icon">
                        <img src="../images/random.png" alt="Random" width="20" height="20">
                    </i>
                    <span>Random</span>
                </a>
            </li>
            <li>
                <a href="../categories.html">
                    <i class="icon">
                        <img src="../images/grid.png" alt="Categories" width="20" height="20">
                    </i>
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="../news.html">
                    <i class="icon">
                        <img src="../images/news.png" alt="News" width="20" height="20">
                    </i>
                    <span>News</span>
                </a>
            </li>
            <li>
                <a href="../settings.html">
                    <i class="icon">
                        <img src="../images/settings.png" alt="Settings" width="20" height="20">
                    </i>
                    <span>Settings</span>
                </a>
            </li>
        </ul>
    </nav>

    <div class="top-bar">
        <button class="sidebar-toggle" id="sidebarToggle">
            <i class="fas fa-bars"></i>
        </button>

        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Search games...">
            <button class="search-btn" id="searchBtn">
                <i class="fas fa-search"></i>
            </button>
            <div class="search-results" id="searchResults">
                <!-- Search results will be displayed here -->
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <div class="game-layout">
            <!-- Game Section -->
            <div class="game-section">
                <!-- Game Canvas Container -->
                <div class="game-container" id="gameContainer">
                    <iframe
                        id="gameFrame"
                        src="https://www.kodub.com/apps/polytrack"
                        width="100%"
                        height="600"
                        frameborder="0"
                        allowfullscreen
                        style="display:block;background:#22224a;border:none;border-bottom:1px solid rgba(138,43,226,0.2);"
                        title="Paper.io Game"
                    ></iframe>

                    <!-- Game Control Bar -->
                    <div class="game-control-bar" id="gameControlBar">
                        <div class="game-title">
                            <h2>Poly Track</h2>
                        </div>
                        <div class="game-controls" style="display: flex; align-items: center; gap: 18px;">
                            <!-- Remove feedback-inline section from here -->
                            <button class="control-btn share-btn" id="shareBtn">
                                <i class="fas fa-share"></i>
                                <span>Share</span>
                            </button>
                            <button class="control-btn fullscreen-btn" id="fullscreenBtn">
                                <i class="fas fa-expand"></i>
                                <span>Fullscreen</span>
                            </button>
                        </div>
                    </div>

                    <!-- Fullscreen Collapse Arrow -->
                    <div class="collapse-arrow" id="collapseArrow">
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>

                <!-- Game Description -->
                <div class="game-description" style="position:relative;">
                    <div class="description-header" style="display:flex; align-items:center; justify-content:space-between;">
                        <h3 style="margin-bottom:0;">About This Game</h3>
                        <!-- Feedback Buttons (moved here, top right corner) -->
                        <div class="feedback-inline" style="display: flex; align-items: center; background: rgba(138,43,226,0.13); border-radius: 16px; box-shadow: 0 2px 8px rgba(138,43,226,0.08); position: relative;">
                            <button id="thumbsUpBtn" style="background: linear-gradient(135deg, #4CAF50 60%, #8a2be2 100%); border: none; cursor: pointer; color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(76,175,80,0.12); transition: transform 0.15s;">
                                <i class="fas fa-thumbs-up"></i>
                            </button>
                            <button id="thumbsDownBtn" style="background: linear-gradient(135deg, #e74c3c 60%, #8a2be2 100%); border: none; cursor: pointer; color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(231,76,60,0.12); transition: transform 0.15s;">
                                <i class="fas fa-thumbs-down"></i>
                            </button>
                            <!-- Floating thumbs container -->
                            <div id="floatingThumbs" style="pointer-events:none; position:absolute; left:0; top:0; width:100%; height:100%; z-index:10;"></div>
                            <div id="voteLock" style="display:none; position:absolute; left:0; top:0; width:100%; height:100%; align-items:center; justify-content:center; pointer-events:auto;">
                                <span style="font-size:1.2em; color:#8a2be2; display:flex; align-items:center; gap:6px;">
                                    <i class="fas fa-lock"></i>
                                    <span style="font-weight:600;">Voted!</span>
                                </span>
                            </div>
                        </div>
                    </div>
                    <p>Poly Track is a fast-paced, low-poly racing experience that puts your skills to the test! Choose your car and race through vibrant, stylized tracks filled with twists, turns, and high-speed challenges. Unlock new vehicles and tracks by setting record times, and climb the global leaderboards to prove you're the fastest racer on the grid. Can you master every course and become the ultimate Poly Track champion?</p>
                    
                    <div class="game-genres">
                        <span class="genre-tag">Online</span>
                        <span class="genre-tag">Racing</span>
                        <span class="genre-tag">Car</span>
                    </div>
                </div>

                <!-- Ad Section -->
                <div class="ad-section">
                    <div class="ad-placeholder">
                        <i class="fas fa-ad"></i>
                        <span>Advertisement</span>
                    </div>
                </div>
            </div>

            <!-- Sidebar Games Section -->
            <div class="sidebar-games">
                <!-- Top Ad -->
                <div class="sidebar-ad">
                    <div class="ad-placeholder small">
                        <i class="fas fa-ad"></i>
                        <span>Ad</span>
                    </div>
                </div>

                <!-- Related Games -->
                <div class="related-games">
                    <h3>More Games</h3>
                    
                    <div class="game-item" data-game="slither-io">
                        <div class="game-thumbnail slither-theme"></div>
                        <div class="game-details">
                            <h4>Slither.io</h4>
                            <p>Snake multiplayer</p>
                        </div>
                    </div>

                    <div class="game-item" data-game="agar-io">
                        <div class="game-thumbnail agar-theme"></div>
                        <div class="game-details">
                            <h4>Agar.io</h4>
                            <p>Cell evolution</p>
                        </div>
                    </div>

                    <div class="game-item" data-game="hole-io">
                        <div class="game-thumbnail hole-theme"></div>
                        <div class="game-details">
                            <h4>Hole.io</h4>
                            <p>Black hole battle</p>
                        </div>
                    </div>

                    <div class="game-item" data-game="wings-io">
                        <div class="game-thumbnail wings-theme"></div>
                        <div class="game-details">
                            <h4>Wings.io</h4>
                            <p>Aerial combat</p>
                        </div>
                    </div>

                    <div class="game-item" data-game="zombs-io">
                        <div class="game-thumbnail zombs-theme"></div>
                        <div class="game-details">
                            <h4>Zombs.io</h4>
                            <p>Zombie survival</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Share Modal -->
    <div class="share-modal" id="shareModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Share Paper.io</h3>
                <button class="close-btn" id="closeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>Share this game with your friends!</p>
                <div class="share-link-container">
                    <input type="text" id="shareLink" value="https://infinitepixels.com/paperio" readonly>
                    <button class="copy-btn" id="copyBtn">Copy</button>
                </div>
                <div class="share-message" id="shareMessage">Link copied to clipboard!</div>
            </div>
        </div>
    </div>

    <script src="../javascript.js"></script>
    <script>
        // Feedback button logic with floating thumbs, only one vote, visual lock
        const thumbsUpBtn = document.getElementById('thumbsUpBtn');
        const thumbsDownBtn = document.getElementById('thumbsDownBtn');
        const floatingThumbs = document.getElementById('floatingThumbs');
        const voteLock = document.getElementById('voteLock');

        // Only allow one vote per session
        let voted = sessionStorage.getItem('paperioVoted') === '1';

        function createFloatingThumbs(type, originBtn) {
            if (!floatingThumbs) return;
            floatingThumbs.innerHTML = '';
            const count = 7;
            for (let i = 0; i < count; i++) {
                const el = document.createElement('span');
                el.className = 'floating-thumb';
                el.innerHTML = type === 'up'
                    ? '<i class="fas fa-thumbs-up"></i>'
                    : '<i class="fas fa-thumbs-down"></i>';
                // Small size
                el.style.fontSize = '1em';
                el.style.opacity = '0.85';
                el.style.color = type === 'up' ? '#4CAF50' : '#e74c3c';
                el.style.position = 'absolute';
                el.style.pointerEvents = 'none';
                // Randomize direction and distance
                const angle = Math.random() * 2 * Math.PI;
                const distance = 40 + Math.random() * 30;
                const x = Math.cos(angle) * distance;
                const y = Math.sin(angle) * distance * (type === 'up' ? -1 : 1);
                const delay = Math.random() * 0.15;
                // For thumbs down, float from the thumbs down button
                let startX = 0, startY = 0;
                if (type === 'down' && originBtn) {
                    // Get position of thumbsDownBtn relative to feedback-inline
                    const parentRect = originBtn.parentElement.getBoundingClientRect();
                    const btnRect = originBtn.getBoundingClientRect();
                    startX = btnRect.left - parentRect.left + btnRect.width / 2 - 14; // 14 = half width of feedback-inline padding
                    startY = btnRect.top - parentRect.top + btnRect.height / 2 - 14;
                } else {
                    // Center between both buttons
                    startX = floatingThumbs.offsetWidth / 2;
                    startY = floatingThumbs.offsetHeight / 2;
                }
                el.style.left = type === 'down' ? `${startX}px` : '50%';
                el.style.top = type === 'down' ? `${startY}px` : '50%';
                el.style.transform = 'translate(-50%, -50%)';
                el.style.animation = type === 'up'
                    ? `thumbsUpFloatSmall 1.1s ${delay}s cubic-bezier(.4,1.4,.7,1) forwards`
                    : `thumbsDownFloatSmall 1.1s ${delay}s cubic-bezier(.4,1.4,.7,1) forwards`;
                el.style.setProperty('--x', `${x}px`);
                el.style.setProperty('--y', `${y}px`);
                floatingThumbs.appendChild(el);
            }
            setTimeout(() => {
                if (floatingThumbs) floatingThumbs.innerHTML = '';
            }, 1300);
        }

        function lockVoting() {
            thumbsUpBtn.disabled = true;
            thumbsDownBtn.disabled = true;
            if (voteLock) {
                voteLock.style.display = 'flex';
                voteLock.style.animation = 'voteLockPop 0.5s cubic-bezier(.4,1.4,.7,1)';
            }
        }

        function unlockVoting() {
            thumbsUpBtn.disabled = false;
            thumbsDownBtn.disabled = false;
            if (voteLock) voteLock.style.display = 'none';
        }

        // On load, show lock if already voted
        if (voted) {
            lockVoting();
        }

        if (thumbsUpBtn && thumbsDownBtn && floatingThumbs && voteLock) {
            [thumbsUpBtn, thumbsDownBtn].forEach(btn => {
                btn.addEventListener('mousedown', () => btn.style.transform = 'scale(0.92)');
                btn.addEventListener('mouseup', () => btn.style.transform = '');
                btn.addEventListener('mouseleave', () => btn.style.transform = '');
            });
            thumbsUpBtn.addEventListener('click', function() {
                if (voted) return;
                lockVoting();
                createFloatingThumbs('up', thumbsUpBtn);
                sessionStorage.setItem('paperioVoted', '1');
                voted = true;
            });
            thumbsDownBtn.addEventListener('click', function() {
                if (voted) return;
                lockVoting();
                createFloatingThumbs('down', thumbsDownBtn);
                sessionStorage.setItem('paperioVoted', '1');
                voted = true;
            });
        }
    </script>
    <style>
    /* Floating thumbs up animation */
    @keyframes thumbsUpFloat {
        0% {
            opacity: 0.85;
            transform: translate(-50%, -50%) scale(1) rotate(var(--angle, 0deg));
        }
        70% {
            opacity: 1;
            transform: translate(calc(-50% + var(--x, 0px)), calc(-50% - var(--y, 60px))) scale(1.2) rotate(var(--angle, 0deg));
        }
        100% {
            opacity: 0;
            transform: translate(calc(-50% + var(--x, 0px)), calc(-50% - var(--y, 90px))) scale(1.1) rotate(var(--angle, 0deg));
        }
    }
    /* Floating thumbs down animation */
    @keyframes thumbsDownFloat {
        0% {
            opacity: 0.85;
            transform: translate(-50%, -50%) scale(1) rotate(var(--angle, 0deg));
        }
        70% {
            opacity: 1;
            transform: translate(calc(-50% + var(--x, 0px)), calc(-50% + var(--y, 60px))) scale(1.2) rotate(var(--angle, 0deg));
        }
        100% {
            opacity: 0;
            transform: translate(calc(-50% + var(--x, 0px)), calc(-50% + var(--y, 90px))) scale(1.1) rotate(var(--angle, 0deg));
        }
    }
    /* Smaller, random floating thumbs up */
    @keyframes thumbsUpFloatSmall {
        0% {
            opacity: 0.85;
            transform: translate(-50%, -50%) scale(1);
        }
        60% {
            opacity: 1;
            transform: translate(calc(-50% + var(--x)), calc(-50% + var(--y))) scale(1.2);
        }
        100% {
            opacity: 0;
            transform: translate(calc(-50% + var(--x)), calc(-50% + var(--y, -60px))) scale(0.9);
        }
    }
    /* Smaller, random floating thumbs down */
    @keyframes thumbsDownFloatSmall {
        0% {
            opacity: 0.85;
            transform: translate(-50%, -50%) scale(1);
        }
        60% {
            opacity: 1;
            transform: translate(calc(-50% + var(--x)), calc(-50% + var(--y))) scale(1.2);
        }
        100% {
            opacity: 0;
            transform: translate(calc(-50% + var(--x)), calc(-50% + var(--y, 60px))) scale(0.9);
        }
    }
    .floating-thumb {
        /* Let JS set animation, color, etc. */
        z-index: 10;
        pointer-events: none;
        filter: drop-shadow(0 2px 4px rgba(0,0,0,0.10));
    }
    #voteLock {
        background: rgba(138,43,226,0.13);
        border-radius: 16px;
        justify-content: center;
        align-items: center;
        width: 100%;
        height: 100%;
        position: absolute;
        left: 0; top: 0;
        z-index: 20;
        font-size: 1.1em;
        pointer-events: auto;
        user-select: none;
        transition: background 0.3s;
    }
    @keyframes voteLockPop {
        0% { transform: scale(0.7); opacity: 0; }
        60% { transform: scale(1.1); opacity: 1; }
        100% { transform: scale(1); opacity: 1; }
    }
    </style>
</body>
</html>